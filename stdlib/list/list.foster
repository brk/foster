
type case List (a:Boxed)
  of $Nil
  of $Cons a (List a)
;

listLength = { forall t:Boxed, xs : List t =>
  case xs
    of $Nil -> 0
    of $Cons _ ys -> 1 +Int32 (listLength ys)
   end;
};


listReverse = { forall t:Boxed, xs : List t =>
  REC go = { xs : List t => acc : List t =>
        case xs
          of $Nil -> acc
          of $Cons x ys -> go ys (Cons x acc)
         end;
  };
  go xs (Nil !)
};
